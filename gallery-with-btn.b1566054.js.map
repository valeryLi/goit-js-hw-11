{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,aAOA,IAAIC,EAAc,EACdC,EAAQ,GAGZC,eAAeC,IACb,MAAMC,EAAS,IAAIC,gBAAgB,CACjCC,IARY,qCASZC,EAAGN,EACHO,KAAMR,EACNS,SAAU,GACVC,WAAY,QACZC,YAAa,cACbC,YAAY,IAGRC,QAAiBC,MAAM,4BAAeV,KAE5C,aADoBS,EAASE,M,CAG/B,MAAMC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,aAAcF,SAASC,cAAc,YACrCE,YAAaH,SAASC,cAAc,eAqBtC,SAASG,EAAcC,GACrB,MAAMC,EAAOD,EAAKC,KACZC,EAAaC,KAAKC,KAAKJ,EAAKK,UA3CtB,IAuDZ,GAXAC,QAAQC,IAAIN,GAEO,IAAfD,EAAKQ,QACPf,EAAKK,YAAYW,UAAUC,IAAI,aAC/BnC,EAAAoC,OAAOC,QACL,6EA8CN,SAA6BC,GAC3B,MAAMC,EAASD,EACZE,KACC,EAACC,cACCA,EAAaC,aACbA,EAAYC,KACZA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,KAEO,oCAAoCN,4CACrCC,WAAsBC,kHAGOC,wFAGAC,2FAGGC,4FAGCC,4CAO1CC,KAAK,IAER9B,EAAKI,aAAa2B,mBAAmB,YAAaV,E,CA5ElDW,CAAoBxB,GAEhBxB,IAAgByB,EAKlB,OAJAT,EAAKK,YAAYW,UAAUC,IAAI,kBAC/BnC,EAAAoC,OAAOe,QACL,8DAKAxB,EAAa,GACfT,EAAKK,YAAYW,UAAUkB,OAAO,aAGb,IAAnB3B,EAAKK,WAAmB5B,EAAc,GACxCF,EAAAoC,OAAOiB,QAAQ,oBAAoB5B,EAAKK,qBAG1C,IAAIwB,EAAAC,GAAJ,CAAmB,cAAe,CAChCC,SAAS,EACTC,KAAK,EACLC,UAAU,EACVC,gBAAgB,EAChBC,OAAO,EACPC,gBAAgB,EAChBC,eAAgB,KAGlB,MAAQC,OAAQC,GAAe5C,SAC5BC,cAAc,YACd4C,kBAAkBC,wBAErBC,OAAOC,SAAS,CACdC,IAAkB,EAAbL,EACLM,SAAU,U,CAId,SAASC,EAAYC,GACnBzC,QAAQC,IAAIwC,E,CArEdtD,EAAKC,KAAKsD,iBAAiB,UAG3B,SAAsBC,GAMpB,GALAA,EAAMC,iBACNxE,EAAQuE,EAAME,OAAOC,SAASC,YAAYC,MAAMC,OAEhD9E,EAAc,EACdgB,EAAKI,aAAa2D,UAAY,IACzB9E,EAIH,YAHAH,EAAAoC,OAAOC,QACL,4EAIJhC,IAAa6E,KAAK1D,GAAe2D,MAAMZ,E,IAdzCrD,EAAKK,YAAYkD,iBAAiB,SA4GlC,WACEvE,GAAe,EACfG,IAAa6E,KAAK1D,GAAe2D,MAAMZ,GACvCa,QAAQC,S","sources":["src/gallery-with-btn.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '30693529-0739abc7bb5433c19d02cabbb';\n\nlet pageToFetch = 1;\nlet query = '';\nlet perPage = 40;\n\nasync function fetchEvent() {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    page: pageToFetch,\n    per_page: 40,\n    image_type: 'photo',\n    orientation: 'orientation',\n    safesearch: true,\n  });\n\n  const response = await fetch(`${BASE_URL}?${params}`);\n  const photo = await response.json();\n  return photo;\n}\nconst refs = {\n  form: document.querySelector('.search-form'),\n  galleryItems: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nrefs.form.addEventListener('submit', onFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', onBtnClick);\n\nfunction onFormSubmit(event) {\n  event.preventDefault();\n  query = event.target.elements.searchQuery.value.trim();\n\n  pageToFetch = 1;\n  refs.galleryItems.innerHTML = '';\n  if (!query) {\n    Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n    return;\n  }\n  fetchEvent().then(handleSuccess).catch(handleError);\n}\n\nfunction handleSuccess(data) {\n  const hits = data.hits;\n  const totalPages = Math.ceil(data.totalHits / perPage);\n  console.log(hits);\n\n  if (data.total === 0) {\n    refs.loadMoreBtn.classList.add('invisible');\n    Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  }\n\n  createGalleryMarkup(hits);\n\n  if (pageToFetch === totalPages) {\n    refs.loadMoreBtn.classList.add('invisible');\n    Notify.warning(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n    return;\n  }\n\n  if (totalPages > 1) {\n    refs.loadMoreBtn.classList.remove('invisible');\n  }\n\n  if (data.totalHits !== 0 && pageToFetch < 2) {\n    Notify.success(`Hooray! We found ${data.totalHits} images.`);\n  }\n\n  new SimpleLightbox('.photo-link', {\n    overlay: true,\n    nav: true,\n    docClose: true,\n    animationSlide: true,\n    close: true,\n    enableKeyboard: true,\n    overlayOpacity: 0.8,\n  });\n\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction handleError(error) {\n  console.log(error);\n}\n\nfunction createGalleryMarkup(events) {\n  const markup = events\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a class='photo-link link' href=\"${largeImageURL}\"><div class=\"photo-card\">\n  <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/>\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b><span class='text'>Likes</span> ${likes}</b>\n    </p>\n    <p class=\"info-item\">\n      <b><span class='text'>Views</span> ${views}</b>\n    </p>\n    <p class=\"info-item\">\n      <b><span class='text'>Comments</span> ${comments}</b>\n    </p>\n    <p class=\"info-item\">\n      <b><span class='text'>Downloads</span> ${downloads}</b>\n    </p>\n  </div>\n</div>\n</a>`;\n      }\n    )\n    .join('');\n\n  refs.galleryItems.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction onBtnClick() {\n  pageToFetch += 1;\n  fetchEvent().then(handleSuccess).catch(handleError);\n  gallery.refresh();\n}\n"],"names":["$iQIUW","parcelRequire","$21d2086b16a56b28$var$pageToFetch","$21d2086b16a56b28$var$query","async","$21d2086b16a56b28$var$fetchEvent","params","URLSearchParams","key","q","page","per_page","image_type","orientation","safesearch","response","fetch","json","$21d2086b16a56b28$var$refs","form","document","querySelector","galleryItems","loadMoreBtn","$21d2086b16a56b28$var$handleSuccess","data","hits","totalPages","Math","ceil","totalHits","console","log","total","classList","add","Notify","failure","events","markup","map","largeImageURL","webformatURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","$21d2086b16a56b28$var$createGalleryMarkup","warning","remove","success","$parcel$interopDefault","$fZKcF","overlay","nav","docClose","animationSlide","close","enableKeyboard","overlayOpacity","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","$21d2086b16a56b28$var$handleError","error","addEventListener","event","preventDefault","target","elements","searchQuery","value","trim","innerHTML","then","catch","gallery","refresh"],"version":3,"file":"gallery-with-btn.b1566054.js.map"}