{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,aAOIC,EAAc,EACdC,EAAQ,GAGNC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,aAAcF,SAASC,cAAc,aAsBvC,SAASE,IAnBT,IACQC,KAAS,IAAIC,gBAAgB,CACjCC,IAbY,qCAcZC,EAAGV,EACHW,KAAMZ,EACNa,SAAU,GACVC,WAAY,QACZC,YAAa,cACbC,YAAY,IAGPC,MAAM,GAAeC,OAvBb,2BAuBU,KAAUA,OAAPV,IAAUW,MAAK,SAAAC,GACzC,IAAKA,EAASC,GACZ,MAAM,IAAIC,MAAMF,EAASG,QAE3B,OAAOH,EAASI,M,KAMfL,MAAK,SAAAM,IAqCV,SAAuBC,GACrB,IAAMC,EAAOD,EAAKC,KACZC,EAAaC,KAAKC,KAAKJ,EAAKK,UAnEtB,IAqEO,IAAfL,EAAKM,OACPlC,EAAAmC,OAAOC,QACL,4EAMJ,GA0BF,SAA6BT,GAC3B,IAAMU,EAASV,EACZW,KACC,SAAAC,G,IACEC,EAAaD,EAAbC,cACAC,EAAYF,EAAZE,aACAC,EAAIH,EAAJG,KACAC,EAAKJ,EAALI,MACAC,EAAKL,EAALK,MACAC,EAAQN,EAARM,SACAC,EAASP,EAATO,UAEA,MAAO,qCACD1B,OADqCoB,EAAc,4CAC7BpB,OAAtBqB,EAAa,WAGgBrB,OAHPsB,EAAK,oHAMEtB,OAHAuB,EAAM,0FAMHvB,OAHHwB,EAAM,6FAMFxB,OAHDyB,EAAS,8FAGEzB,OAAV0B,EAAU,yC,IAOpDC,KAAK,IAER3C,EAAKI,aAAawC,mBAAmB,YAAaX,E,CA9DlDY,CAAoBpB,GAEhB3B,IAAgB4B,EAIlB,YAHA9B,EAAAmC,OAAOe,QACL,8DAKmB,IAAnBtB,EAAKK,WAAmB/B,EAAc,GACxCF,EAAAmC,OAAOgB,QAAQ,oBAAmC/B,OAAfQ,EAAKK,UAAU,aAGpD,IAAImB,EAAAC,GAAJ,CAAmB,cAAe,CAChCC,SAAS,EACTC,KAAK,EACLC,UAAU,EACVC,gBAAgB,EAChBC,OAAO,EACPC,gBAAgB,EAChBC,eAAgB,I,CAlEdC,CAAclC,GACdzB,GAAe,EACf4D,EAASC,QAAQzD,SAASC,cAAc,0B,IAEzCyD,MAAMC,E,CAGX7D,EAAKC,KAAK6D,iBAAiB,UAE3B,SAAsBC,GAMpB,GALAA,EAAMC,iBACNjE,EAAQgE,EAAME,OAAOC,SAASC,YAAYC,MAAMC,OAEhDvE,EAAc,EACdE,EAAKI,aAAakE,UAAY,IACzBvE,EAIH,YAHAH,EAAAmC,OAAOC,QACL,4EAIJ3B,G,IAGF,IAAMqD,EAAW,IAAIa,sBACnB,SAACC,EAASC,GACRD,EAAQE,SAAQ,SAAAC,GACVA,EAAMC,gBACRH,EAASI,UAAUF,EAAMV,QAE3B5D,G,MAGJ,CAAEyE,UAAW,KAqCf,SAASjB,EAAYkB,GACnBC,QAAQC,IAAIF,E","sources":["src/infinity-scroll.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '30693529-0739abc7bb5433c19d02cabbb';\n\nlet pageToFetch = 1;\nlet query = '';\nlet perPage = 40;\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  galleryItems: document.querySelector('.gallery'),\n};\n\nfunction fetchImages() {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    page: pageToFetch,\n    per_page: 40,\n    image_type: 'photo',\n    orientation: 'orientation',\n    safesearch: true,\n  });\n\n  return fetch(`${BASE_URL}?${params}`).then(response => {\n    if (!response.ok) {\n      throw new Error(response.status);\n    }\n    return response.json();\n  });\n}\n\nfunction getImages() {\n  fetchImages()\n    .then(events => {\n      handleSuccess(events);\n      pageToFetch += 1;\n      observer.observe(document.querySelector('.photo-card:last-child'));\n    })\n    .catch(handleError);\n}\n\nrefs.form.addEventListener('submit', onFormSubmit);\n\nfunction onFormSubmit(event) {\n  event.preventDefault();\n  query = event.target.elements.searchQuery.value.trim();\n\n  pageToFetch = 1;\n  refs.galleryItems.innerHTML = '';\n  if (!query) {\n    Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n    return;\n  }\n  getImages();\n}\n\nconst observer = new IntersectionObserver(\n  (entries, observer) => {\n    entries.forEach(entry => {\n      if (entry.isIntersecting) {\n        observer.unobserve(entry.target);\n      }\n      getImages();\n    });\n  },\n  { threshold: 0.5 }\n);\n\nfunction handleSuccess(data) {\n  const hits = data.hits;\n  const totalPages = Math.ceil(data.totalHits / perPage);\n\n  if (data.total === 0) {\n    Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  }\n\n  createGalleryMarkup(hits);\n\n  if (pageToFetch === totalPages) {\n    Notify.warning(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n    return;\n  }\n\n  if (data.totalHits !== 0 && pageToFetch < 2) {\n    Notify.success(`Hooray! We found ${data.totalHits} images.`);\n  }\n\n  new SimpleLightbox('.photo-link', {\n    overlay: true,\n    nav: true,\n    docClose: true,\n    animationSlide: true,\n    close: true,\n    enableKeyboard: true,\n    overlayOpacity: 0.8,\n  });\n}\n\nfunction handleError(error) {\n  console.log(error);\n}\n\nfunction createGalleryMarkup(events) {\n  const markup = events\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a class='photo-link link' href=\"${largeImageURL}\"><div class=\"photo-card\">\n  <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/>\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b><span class='text'>Likes</span> ${likes}</b>\n    </p>\n    <p class=\"info-item\">\n      <b><span class='text'>Views</span> ${views}</b>\n    </p>\n    <p class=\"info-item\">\n      <b><span class='text'>Comments</span> ${comments}</b>\n    </p>\n    <p class=\"info-item\">\n      <b><span class='text'>Downloads</span> ${downloads}</b>\n    </p>\n  </div>\n</div>\n</a>`;\n      }\n    )\n    .join('');\n\n  refs.galleryItems.insertAdjacentHTML('beforeend', markup);\n}\n"],"names":["$h6c0i","parcelRequire","$1a6ea5a358f44918$var$pageToFetch","$1a6ea5a358f44918$var$query","$1a6ea5a358f44918$var$refs","form","document","querySelector","galleryItems","$1a6ea5a358f44918$var$getImages","params","URLSearchParams","key","q","page","per_page","image_type","orientation","safesearch","fetch","concat","then","response","ok","Error","status","json","events","data","hits","totalPages","Math","ceil","totalHits","total","Notify","failure","markup","map","param","largeImageURL","webformatURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","$1a6ea5a358f44918$var$createGalleryMarkup","warning","success","$parcel$interopDefault","$5IjG7","overlay","nav","docClose","animationSlide","close","enableKeyboard","overlayOpacity","$1a6ea5a358f44918$var$handleSuccess","$1a6ea5a358f44918$var$observer","observe","catch","$1a6ea5a358f44918$var$handleError","addEventListener","event","preventDefault","target","elements","searchQuery","value","trim","innerHTML","IntersectionObserver","entries","observer1","forEach","entry","isIntersecting","unobserve","threshold","error","console","log"],"version":3,"file":"infiniti-scroll.266d4acb.js.map"}